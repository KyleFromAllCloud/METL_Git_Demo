{"job":{"components":{"64217":{"id":64217,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-2256,"y":-304,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[64282],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64218":{"id":64218,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":-1936,"y":-432,"width":32,"height":32,"inputConnectorIDs":[64274],"outputSuccessConnectorIDs":[64268],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Employee API"}}}},"visible":true},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":false},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Employees"}}}},"visible":true},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Employees_auth"}}}},"visible":false},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true},"14":{"slot":14,"name":"Header Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Authentication"},"2":{"slot":2,"type":"STRING","value":"${auth_token}"}}}},"visible":true},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":null}}}},"visible":false},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://matilliondevqastorage/matilliondevqacontainer/"}}}},"visible":true},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"EMPLOYEE_API"}}}},"visible":true},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64219":{"id":64219,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-2128,"y":-304,"width":32,"height":32,"inputConnectorIDs":[64282],"outputSuccessConnectorIDs":[64263,64266,64274,64275,64278,64281],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Wurk Auth"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"import requests\nfrom datetime import datetime, timedelta\nfrom azure.keyvault.secrets import SecretClient\nfrom azure.identity import DefaultAzureCredential\n\ntoken_credential = DefaultAzureCredential()\n\napi_url = 'https://secure.saashr.com/ta/rest/v1/login'\napi_key = 'abjrfh1iwjw4v0x2qgzmhid1dcw4tg8s'\napi_user = 'TSVC_Data_Analytics33'\napi_pass = '8)FgEd731'\napi_company = 'CuraleafInc'\n\nurl = api_url\nheaders = {'Content-Type' : 'application/json', 'Api-Key' : api_key }\n\nauthJson = {\n  \"credentials\": {\n    \"username\": api_user,\n    \"password\": api_pass,\n    \"company\": api_company\n  }\n}\n\nr = requests.post(url, headers=headers, json=authJson)\n\nif r.status_code == 200:\n\tdata = r.json()\n    \n\ttoken = data['token']\n\t#print(token)\n\tcontext.updateVariable('auth_token', 'Bearer ' + token)\n\t#print(token)\n    \nelse:\n\traise Exception('Failed to Authenticate Wurk API')\n\n#get start and end date for api calls\nd = datetime.today() - timedelta(days=1)\n\nstart_date = d.strftime(\"%Y-%m-%d\")\nend_date = d.strftime(\"%Y-%m-%d\")\n\ncontext.updateVariable('start_date', start_date)\ncontext.updateVariable('end_date', end_date)\n\nprint(\"start_date: \" + start_date)\nprint(\"end_date: \" + end_date)"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64220":{"id":64220,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":-1936,"y":-304,"width":32,"height":32,"inputConnectorIDs":[64275],"outputSuccessConnectorIDs":[64270],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Attendance API"}}}},"visible":true},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":false},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Attendance"}}}},"visible":true},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true},"14":{"slot":14,"name":"Header Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Authentication"},"2":{"slot":2,"type":"STRING","value":"${auth_token}"}}}},"visible":true},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://matilliondevqastorage/matilliondevqacontainer/"}}}},"visible":true},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ATTENDANCE_API"}}}},"visible":true},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64221":{"id":64221,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-1792,"y":-432,"width":32,"height":32,"inputConnectorIDs":[64268],"outputSuccessConnectorIDs":[64269],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Employee"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"EMPLOYEE"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64222":{"id":64222,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1616,"y":-432,"width":32,"height":32,"inputConnectorIDs":[64269],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Employee JSON Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into DEV_EDW_STG.WURK.EMPLOYEE\nselect   \n    f.value:id::int as id,\n    f.value:employee_id::string as employee_id,\n    f.value:username::string as username,\n    f.value:first_name::string as first_name,\n    f.value:last_name::string as last_name,\n    f.value:primary_account_id::int as primary_account_id,\n    f.value:ein_name::string as ein_name,\n    f.value:_links:self::string as _links_self,\n    f.value:_links:demographics::string as _links_demographics,\n    f.value:_links:badges::string as _links_badges,\n    f.value:_links:\"pay-info\"::string as _links_pay_info,\n    f.value:_links:profiles::string as _links_profiles,\n    f.value:status::string as status,\n    f.value:dates:hired::date as dates_hired,\n    f.value:dates:started::date as dates_started,\n    f.value:dates:terminated::date as dates_terminated    \n    \nfrom \"DEV_EDW_STG\".\"WURK\".\"EMPLOYEE_API\", table(flatten(\"Data Value\":employees)) f;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64223":{"id":64223,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-1792,"y":-304,"width":32,"height":32,"inputConnectorIDs":[64270],"outputSuccessConnectorIDs":[64279],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Attendance"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ATTENDANCE"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64224":{"id":64224,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1632,"y":-304,"width":32,"height":32,"inputConnectorIDs":[64279],"outputSuccessConnectorIDs":[64424],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Attendance JSON Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into DEV_EDW_STG.WURK.ATTENDANCE\nselect   \n  f.value:employee:account_id::int as employee_account_id,\n  f.value:employee:display_name::string as employee_display_name,\n  f.value:status::string as status  \n    \nfrom \"DEV_EDW_STG\".\"WURK\".\"ATTENDANCE_API\", table(flatten(\"Data Value\":attendance)) f;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64225":{"id":64225,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":-1984,"y":48,"width":32,"height":32,"inputConnectorIDs":[64266],"outputSuccessConnectorIDs":[64271],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Time Entry API"}}}},"visible":true},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":false},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Time Entries"}}}},"visible":true},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true},"13":{"slot":13,"name":"Query Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"start_date"},"2":{"slot":2,"type":"STRING","value":"${start_date}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"end_date"},"2":{"slot":2,"type":"STRING","value":"${end_date}"}}}},"visible":true},"14":{"slot":14,"name":"Header Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Authentication"},"2":{"slot":2,"type":"STRING","value":"${auth_token}"}}}},"visible":true},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://matilliondevqastorage/matilliondevqacontainer/"}}}},"visible":true},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TIME_ENTRY_API"}}}},"visible":true},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64226":{"id":64226,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-1808,"y":128,"width":32,"height":32,"inputConnectorIDs":[64271],"outputSuccessConnectorIDs":[64273,64277],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Time_Entry Cost_Center"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TIME_ENTRY"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"COST_CENTER"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64227":{"id":64227,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1648,"y":112,"width":32,"height":32,"inputConnectorIDs":[64273],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Time_Entry JSON Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into DEV_EDW_STG.WURK.TIME_ENTRY\nselect   \n   f2.value:id::int as time_entry_id\n   ,f.value:employee:account_id::int as employee_account_id\n   --f.value:start_date::date as time_entries_start_date,\n   --f.value:end_date::date as time_entries_end_date,\n   ,f2.value:date::date as time_entry_date\n   ,f2.value:total::int as time_entry_total\n   ,f2.value:type::varchar as time_entry_type\n   ,f2.value:approval_status::varchar as time_entry_approval_status\n   ,f2.value:calc_total::int as time_entry_calc_total\n   ,f2.value:is_raw::boolean as time_entry_is_raw\n   ,f2.value:is_calc::boolean as time_entry_is_calc\n   \n    \nfrom \"DEV_EDW_STG\".\"WURK\".\"TIME_ENTRY_API\"\n  ,table(flatten(\"Data Value\":time_entry_sets)) f\n  ,LATERAL FLATTEN(f.value:time_entries) F2;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64228":{"id":64228,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1664,"y":192,"width":32,"height":32,"inputConnectorIDs":[64277],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Cost_Center JSON Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into DEV_EDW_STG.WURK.COST_CENTER\nselect   \n   --f.value:employee:account_id::int as employee_account_id\n   f2.value:id::int as time_entry_id\n   ,f3.value:index::int as time_entry_cost_center_index\n   ,f3.value:value:id::int as time_entry_cost_center_value_id   \n    \nfrom \"DEV_EDW_STG\".\"WURK\".\"TIME_ENTRY_API\"\n  ,table(flatten(\"Data Value\":time_entry_sets)) f\n  ,LATERAL FLATTEN(f.value:time_entries) F2\n  ,LATERAL FLATTEN(f2.value:cost_centers) F3;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64229":{"id":64229,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":-1936,"y":-192,"width":32,"height":32,"inputConnectorIDs":[64278],"outputSuccessConnectorIDs":[64267],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Payrolls API"}}}},"visible":true},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":false},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Payrolls"}}}},"visible":true},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true},"14":{"slot":14,"name":"Header Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Authentication"},"2":{"slot":2,"type":"STRING","value":"${auth_token}"}}}},"visible":true},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://matilliondevqastorage/matilliondevqacontainer/"}}}},"visible":true},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAYROLLS_API"}}}},"visible":true},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64230":{"id":64230,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-1792,"y":-192,"width":32,"height":32,"inputConnectorIDs":[64267],"outputSuccessConnectorIDs":[64276],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate Payrolls"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAYROLLS"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64231":{"id":64231,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1632,"y":-192,"width":32,"height":32,"inputConnectorIDs":[64276],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Payrolls JSON Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into DEV_EDW_STG.WURK.PAYROLLS\nselect   \n    f.value:id::int as id,\n    f.value:name::string as name,\n    f.value:pay_date::date as pay_date,\n    f.value:start_date::date as start_date,\n    f.value:end_date::date as end_date,\n    f.value:type:id::int as type_id,\n    f.value:type:display_name::string as type_display_name,\n    f.value:ein:id::int as ein_id,\n    f.value:ein:ein_name::string as ein_name,\n    f.value:ein:ein_tax_id::string as ein_tax_id,\n    f.value:status::string as status,\n    f.value:billable::boolean as billable,\n    f.value:_links:self::string as links_self\n    \nfrom \"DEV_EDW_STG\".\"WURK\".\"PAYROLLS_API\", table(flatten(\"Data Value\":payrolls)) f;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64232":{"id":64232,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1043089869,"x":-1936,"y":-48,"width":32,"height":32,"inputConnectorIDs":[64263],"outputSuccessConnectorIDs":[64264],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pay Periods API"}}}},"visible":true},"2":{"slot":2,"name":"API","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":false},"3":{"slot":3,"name":"API Environment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Production"}}}},"visible":false},"4":{"slot":4,"name":"API Version","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"default"}}}},"visible":false},"5":{"slot":5,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pay Periods"}}}},"visible":true},"6":{"slot":6,"name":"Auth Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":null}}}},"visible":false},"7":{"slot":7,"name":"Api Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"8":{"slot":8,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"9":{"slot":9,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"10":{"slot":10,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"11":{"slot":11,"name":"Page Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"1"}}}},"visible":true},"12":{"slot":12,"name":"URI Params","elements":{},"visible":true},"13":{"slot":13,"name":"Query Params","elements":{},"visible":true},"14":{"slot":14,"name":"Header Params","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Authentication"},"2":{"slot":2,"type":"STRING","value":"${auth_token}"}}}},"visible":true},"15":{"slot":15,"name":"Post Body","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"16":{"slot":16,"name":"Api Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"17":{"slot":17,"name":"Api Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"18":{"slot":18,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"22":{"slot":22,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"113":{"slot":113,"name":"Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://matilliondevqastorage/matilliondevqacontainer/"}}}},"visible":true},"114":{"slot":114,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"115":{"slot":115,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"116":{"slot":116,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"117":{"slot":117,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAY_PERIODS_API"}}}},"visible":true},"118":{"slot":118,"name":"Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64233":{"id":64233,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-1808,"y":-48,"width":32,"height":32,"inputConnectorIDs":[64264],"outputSuccessConnectorIDs":[64280],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pay Periods Truncate"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"PAY_PERIODS"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64234":{"id":64234,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1632,"y":-48,"width":32,"height":32,"inputConnectorIDs":[64280],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Pay Periods JSON Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into DEV_EDW_STG.WURK.PAY_PERIODS\nselect   \n    f.value:id::int as id,\n\tf.value:display_name::string as display_name,\n\tf.value:profile_name::string as profile_name,\n\tf.value:pay_period_profile:id::string as pay_period_profile_id,\n    f.value:ein:id::int as ein_id,\n    f.value:ein:ein_name::string as ein_name,\n    f.value:ein:ein_tax_id::string as ein_tax_id,\n\tf.value:total_employees::int as total_employees,\n\tf.value:locked_employees::int as locked_employees,\n\tf.value:available_employees::int as available_employees,\n\tf.value:start_date::date as start_date,\n\tf.value:end_date::date as end_date,\n\tf.value:locked::boolean as locked,\n\tf.value:pay_date::date as pay_date,\n\tf.value:submit_date::date as submit_date,\n\tf.value:process_date::date as process_date\n    \nfrom \"DEV_EDW_STG\".\"WURK\".\"PAY_PERIODS_API\", table(flatten(\"Data Value\":pay_periods)) f;"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64235":{"id":64235,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1214167305,"x":-1952,"y":-576,"width":32,"height":32,"inputConnectorIDs":[64281],"outputSuccessConnectorIDs":[64265],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SR_ACTIVE_ROSTER_AO_BUDGET API"}}}},"visible":true},"2":{"slot":2,"name":"Basic/Advanced Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Basic"}}}},"visible":true},"6":{"slot":6,"name":"Data Source","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"sr_active_roster_ao_for_budget_no_payroll"}}}},"visible":true},"7":{"slot":7,"name":"Data Selection","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"col"}}}},"visible":true},"8":{"slot":8,"name":"Data Source Filter","elements":{},"visible":true},"9":{"slot":9,"name":"Combine Filters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"10":{"slot":10,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT ..."}}}},"visible":false},"11":{"slot":11,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"12":{"slot":12,"name":"Connection Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CustomHeaders"},"2":{"slot":2,"type":"STRING","value":"Authorization: ${auth_token}"}}}},"visible":true},"13":{"slot":13,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"14":{"slot":14,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"15":{"slot":15,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SR_ACTIVE_ROSTER_AO_BUDGET_API"}}}},"visible":true},"16":{"slot":16,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"17":{"slot":17,"name":"S3 Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"18":{"slot":18,"name":"Primary Keys","elements":{},"visible":true},"20":{"slot":20,"name":"Data Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"100":{"slot":100,"name":"Profile","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Wurk"}}}},"visible":true},"499":{"slot":499,"name":"Authentication Method","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Other"}}}},"visible":true},"500":{"slot":500,"name":"Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"501":{"slot":501,"name":"Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"PASSWORD","value":""}}}},"visible":false},"502":{"slot":502,"name":"Bearer Token","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${auth_token}"}}}},"visible":false},"503":{"slot":503,"name":"OAuth","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"504":{"slot":504,"name":"Key Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Authentication"}}}},"visible":false},"505":{"slot":505,"name":"Key Value","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"506":{"slot":506,"name":"Add Authorization To","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Request Header"}}}},"visible":false},"1001":{"slot":1001,"name":"","elements":{},"visible":false},"1013":{"slot":1013,"name":"Auto Debug","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}}},"visible":true},"1014":{"slot":1014,"name":"Debug Level","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"3"}}}},"visible":false},"1992":{"slot":1992,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1993":{"slot":1993,"name":"Use Accelerated Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"1994":{"slot":1994,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1995":{"slot":1995,"name":"Stage Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1996":{"slot":1996,"name":"Stage Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1997":{"slot":1997,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"1998":{"slot":1998,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"1999":{"slot":1999,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"2000":{"slot":2000,"name":"Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Standard"}}}},"visible":true},"40000":{"slot":40000,"name":"Encryption","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"40001":{"slot":40001,"name":"KMS Key ID","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"40501":{"slot":40501,"name":"","elements":{},"visible":false},"40502":{"slot":40502,"name":"Load Options","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"Off"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"On"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"Gzip"}}}},"visible":true},"63319":{"slot":63319,"name":"Stage Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":false},"63320":{"slot":63320,"name":"Storage Account","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63321":{"slot":63321,"name":"Blob Container","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"63322":{"slot":63322,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"84533":{"slot":84533,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88340":{"slot":88340,"name":"","elements":{},"visible":false},"88341":{"slot":88341,"name":"Stage Platform","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Snowflake Managed"}}}},"visible":true},"88342":{"slot":88342,"name":"Stage Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":false},"88343":{"slot":88343,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"88344":{"slot":88344,"name":"Use Accelerated Endpoint","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"88345":{"slot":88345,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"98776":{"slot":98776,"name":"GCS Staging Area","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64236":{"id":64236,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":237373210,"x":-1792,"y":-576,"width":32,"height":32,"inputConnectorIDs":[64265],"outputSuccessConnectorIDs":[64272],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Truncate SR_ACTIVE_ROSTER_AO_BUDGET"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"4":{"slot":4,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"WURK"}}}},"visible":true},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SR_ACTIVE_ROSTER_AO_BUDGET"}}}},"visible":true},"6":{"slot":6,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64237":{"id":64237,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":-1616,"y":-576,"width":32,"height":32,"inputConnectorIDs":[64272],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SR_ACTIVE_ROSTER_AO_BUDGET Flatten"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"insert into ${environment_name}_EDW_STG.\"WURK\".\"SR_ACTIVE_ROSTER_AO_BUDGET\"\n\n(EMPLOYEE_ID, FIRST_NAME, LAST_NAME, PAY_TYPE, ORG_STRUCTURE_DIVISION, ORG_STRUCTURE_DEPARTMENT, ORG_STRUCTURE_SUB_DEPARTMENT, JOBS_HR_1, WORK_LOCATION_1, \n WORK_LOCATION_2, DEFAULT_WORK_LOCATION_EXTERNAL_ID, DEFAULT_ORG_STRUCTURE_DEPARTMENT_NUMBER, EMPLOYEE_STATUS, EMPLOYEE_TYPE, DATE_HIRED, DATE_STARTED, \n DATE_TERMINATED, EMPLOYEE_EIN, PAYROLL_DEPARTMENT_1)\n\nselect  \n  TRY_CAST(EMPLOYEE_ID AS INT), \n  FIRST_NAME, \n  LAST_NAME, \n  PAY_TYPE, \n  ORG_STRUCTURE_DIVISION, \n  ORG_STRUCTURE_DEPARTMENT, \n  ORG_STRUCTURE_SUB_DEPARTMENT, \n  JOBS_HR_1, \n  WORK_LOCATION_1, \n  WORK_LOCATION_2, \n  TRY_CAST(DEFAULT_WORK_LOCATION_EXTERNAL_ID AS INT), \n  TRY_CAST(DEFAULT_ORG_STRUCTURE_DEPARTMENT_NUMBER AS INT), \n  EMPLOYEE_STATUS, \n  EMPLOYEE_TYPE, \n  TRY_CAST(DATE_HIRED AS DATE), \n  TRY_CAST(DATE_STARTED AS DATE), \n  TRY_CAST(DATE_TERMINATED AS DATE), \n  EMPLOYEE_EIN, \n  PAYROLL_DEPARTMENT_1\nfrom \n\n(SELECT \n   STRTOK_TO_ARRAY(REPLACE(REPLACE(REPLACE(REPLACE(\"col\", '<col></col>', '~NULL~'), '</col><col>', '~'), '<col>', ''), '</col>', ''), '~') AS arr \n  ,arr[0]::string AS EMPLOYEE_ID\n  ,arr[1]::string AS FIRST_NAME\n  ,arr[2]::string AS LAST_NAME\n  ,arr[3]::string AS PAY_TYPE\n  ,arr[4]::string AS ORG_STRUCTURE_DIVISION\n  ,arr[5]::string AS ORG_STRUCTURE_DEPARTMENT\n  ,arr[6]::string AS ORG_STRUCTURE_SUB_DEPARTMENT\n  ,arr[7]::string AS JOBS_HR_1\n  ,arr[8]::string AS WORK_LOCATION_1\n  ,arr[9]::string AS WORK_LOCATION_2\n  ,arr[10]::string AS DEFAULT_WORK_LOCATION_EXTERNAL_ID\n  ,arr[11]::string AS DEFAULT_ORG_STRUCTURE_DEPARTMENT_NUMBER\n  ,arr[12]::string AS EMPLOYEE_STATUS\n  ,arr[13]::string AS EMPLOYEE_TYPE\n  ,arr[14]::string AS DATE_HIRED\n  ,arr[15]::string AS DATE_STARTED\n  ,arr[16]::string AS DATE_TERMINATED\n  ,arr[17]::string AS EMPLOYEE_EIN\n  ,arr[18]::string AS PAYROLL_DEPARTMENT_1\n\nFROM ${environment_name}_EDW_STG.\"WURK\".\"SR_ACTIVE_ROSTER_AO_BUDGET_API\") api"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"64423":{"id":64423,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1204049670,"x":-1515,"y":-310,"width":32,"height":32,"inputConnectorIDs":[64424],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"emails 0"}}}},"visible":true},"2":{"slot":2,"name":"JV_Reply_Email","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"svc_Matillion@curaleaf.com"}}}},"visible":true},"3":{"slot":3,"name":"JV_Sender_Email","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"svc_Matillion@curaleaf.com"}}}},"visible":true},"4":{"slot":4,"name":"JV_Email_Subject","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Matillion Job Failure"}}}},"visible":true},"5":{"slot":5,"name":"JV_Main_Job_Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${job_name}"}}}},"visible":true},"6":{"slot":6,"name":"JV_SMTP_HostName","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"smtp.office365.com"}}}},"visible":true},"7":{"slot":7,"name":"JV_SMTP_Password","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SMTP Password"}}}},"visible":true},"8":{"slot":8,"name":"JV_SMTP_Username","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"svc_Matillion@curaleaf.com"}}}},"visible":true},"9":{"slot":9,"name":"GV_Recipients_Email","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"64263":{"id":64263,"sourceID":64219,"targetID":64232},"64264":{"id":64264,"sourceID":64232,"targetID":64233},"64265":{"id":64265,"sourceID":64235,"targetID":64236},"64266":{"id":64266,"sourceID":64219,"targetID":64225},"64267":{"id":64267,"sourceID":64229,"targetID":64230},"64268":{"id":64268,"sourceID":64218,"targetID":64221},"64269":{"id":64269,"sourceID":64221,"targetID":64222},"64270":{"id":64270,"sourceID":64220,"targetID":64223},"64271":{"id":64271,"sourceID":64225,"targetID":64226},"64272":{"id":64272,"sourceID":64236,"targetID":64237},"64273":{"id":64273,"sourceID":64226,"targetID":64227},"64274":{"id":64274,"sourceID":64219,"targetID":64218},"64275":{"id":64275,"sourceID":64219,"targetID":64220},"64276":{"id":64276,"sourceID":64230,"targetID":64231},"64277":{"id":64277,"sourceID":64226,"targetID":64228},"64278":{"id":64278,"sourceID":64219,"targetID":64229},"64279":{"id":64279,"sourceID":64223,"targetID":64224},"64280":{"id":64280,"sourceID":64233,"targetID":64234},"64281":{"id":64281,"sourceID":64219,"targetID":64235},"64424":{"id":64424,"sourceID":64224,"targetID":64423}},"failureConnectors":{},"unconditionalConnectors":{"64282":{"id":64282,"sourceID":64217,"targetID":64219}},"trueConnectors":{},"falseConnectors":{},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"auth_token":{"definition":{"name":"auth_token","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"end_date":{"definition":{"name":"end_date","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""},"start_date":{"definition":{"name":"start_date","type":"TEXT","scope":"TASKBATCH","description":"","visibility":"PRIVATE"},"value":""}},"grids":{}},"info":{"name":"Wurk Data Extract (1)","description":"","type":"ORCHESTRATION","tag":"36a258ef-de06-4281-95f2-1d5430ecd2f2"}}
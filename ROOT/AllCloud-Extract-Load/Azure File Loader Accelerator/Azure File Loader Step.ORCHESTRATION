{"job":{"components":{"2080":{"id":2080,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":256,"y":0,"width":32,"height":32,"inputConnectorIDs":[2104],"outputSuccessConnectorIDs":[2112],"outputFailureConnectorIDs":[2117],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create STG Table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetDatabase}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetSchema}"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TableName}"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"GRD_ColumnNames"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Column_Name"},"2":{"slot":2,"type":"GRID","value":"Data_Type"},"3":{"slot":3,"type":"GRID","value":"Size"},"4":{"slot":4,"type":"GRID","value":"Precision"},"5":{"slot":5,"type":"GRID","value":"Default_Value"},"6":{"slot":6,"type":"GRID","value":"Not_Null"},"7":{"slot":7,"type":"GRID","value":"Unique_Value"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create if not exists"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Transient"}}}},"visible":true},"13":{"slot":13,"name":"Default DDL Collation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2081":{"id":2081,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-672,"y":112,"width":32,"height":32,"inputConnectorIDs":[2114],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Logging - File Not Defined"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Audit Logging"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"DISABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2082":{"id":2082,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-192,"y":0,"width":32,"height":32,"inputConnectorIDs":[2105],"outputSuccessConnectorIDs":[2106],"outputFailureConnectorIDs":[2120],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get File Load Parameters"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT DISTINCT TARGET_DATABASE\n\t\t\t\t, TARGET_SCHEMA\n                , TARGET_TABLE_NAME\n                , FIELD_DELIMITER\n                , SKIP_HEADER\n                , FIELD_ENCLOSED\n                , TABLEFROMFILENAME_PATTERN\nFROM\t${ETL_DATABASE}.${ETL_SCHEMA}.${FILE_LOADER_TABLE}\nWHERE\t UPPER('${FILENAME}') LIKE UPPER(SOURCE_FILENAME) ESCAPE '^'"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_Field_Delimiter"},"2":{"slot":2,"type":"STRING","value":"FIELD_DELIMITER"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TargetDatabase"},"2":{"slot":2,"type":"STRING","value":"TARGET_DATABASE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TargetSchema"},"2":{"slot":2,"type":"STRING","value":"TARGET_SCHEMA"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TargetTable"},"2":{"slot":2,"type":"STRING","value":"TARGET_TABLE_NAME"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"JV_SkipHeader"},"2":{"slot":2,"type":"STRING","value":"SKIP_HEADER"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"JV_FieldEnclosed"},"2":{"slot":2,"type":"STRING","value":"FIELD_ENCLOSED"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TableFromFileNamePattern"},"2":{"slot":2,"type":"STRING","value":"TABLEFROMFILENAME_PATTERN"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2083":{"id":2083,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-848,"y":-128,"width":32,"height":32,"inputConnectorIDs":[2119],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error - File Name Issue"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"${JV_Message}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_JOB_ID"},"2":{"slot":2,"type":"STRING","value":"${run_history_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_RUN_KEY"},"2":{"slot":2,"type":"STRING","value":"${JV_Status}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"${JV_TargetTable}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2084":{"id":2084,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1155583855,"x":-496,"y":0,"width":32,"height":32,"inputConnectorIDs":[2113],"outputSuccessConnectorIDs":[2109],"outputFailureConnectorIDs":[2121],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get list of Column Names"}}}},"visible":true},"2":{"slot":2,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true},"3":{"slot":3,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"  select TARGET_COLUMN_NAME\n  \t\t, DATA_TYPE\n        , PRECISION\n        , IFNULL(SIZE,0) as SIZE\n        , DEFAULT_VALUE\n        , NOT_NULL\n        , UNIQUE_VALUE\n    from ${ETL_DATABASE}.${ETL_SCHEMA}.${FILE_LOADER_TABLE}\n    WHERE  UPPER('${FILENAME}') LIKE UPPER(SOURCE_FILENAME) ESCAPE '^'\n    ORDER BY SOURCE_COLUMN_ORDINAL"}}}},"visible":true},"8":{"slot":8,"name":"Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRD_ColumnNames"}}}},"visible":true},"9":{"slot":9,"name":"Grid Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TARGET_COLUMN_NAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"DATA_TYPE"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"SIZE"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"PRECISION"}}},"5":{"slot":5,"values":{"1":{"slot":1,"type":"STRING","value":"DEFAULT_VALUE"}}},"6":{"slot":6,"values":{"1":{"slot":1,"type":"STRING","value":"NOT_NULL"}}},"7":{"slot":7,"values":{"1":{"slot":1,"type":"STRING","value":"UNIQUE_VALUE"}}}},"visible":true},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2085":{"id":2085,"inputCardinality":"ZERO","outputCardinality":"MANY","connectorHint":"UNCONDITIONAL","executionHint":"FLOW","implementationID":444132438,"x":-1008,"y":0,"width":32,"height":32,"inputConnectorIDs":[],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[2115],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Start","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Start 0"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2086":{"id":2086,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"CONDITIONAL","executionHint":"FLOW","implementationID":-1357378929,"x":-672,"y":0,"width":32,"height":32,"inputConnectorIDs":[2103],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[2113],"outputFalseConnectorIDs":[2114],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Is the File Defined in Alias Table?"}}}},"visible":true},"2":{"slot":2,"name":"Mode","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Simple"}}}},"visible":true},"3":{"slot":3,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_NumberColumns"},"2":{"slot":2,"type":"STRING","value":"Is"},"3":{"slot":3,"type":"STRING","value":"Greater than"},"4":{"slot":4,"type":"STRING","value":"0"}}}},"visible":true},"4":{"slot":4,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"And"}}}},"visible":true},"5":{"slot":5,"name":"Condition","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2087":{"id":2087,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1032749985,"x":-848,"y":0,"width":32,"height":32,"inputConnectorIDs":[2115],"outputSuccessConnectorIDs":[2103],"outputFailureConnectorIDs":[2119],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Get the Number of Columns"}}}},"visible":true},"2":{"slot":2,"name":"SQL Query","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SELECT COUNT(*) as NUM_COLUMNS\nFROM ${ETL_DATABASE}.${ETL_SCHEMA}.${FILE_LOADER_TABLE}\nWHERE  UPPER('${FILENAME}') LIKE UPPER(SOURCE_FILENAME) ESCAPE '^'\n\t\tAND FILE_LOAD_ENABLED = TRUE"}}}},"visible":true},"3":{"slot":3,"name":"Scalar Variable Mapping","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_NumberColumns"},"2":{"slot":2,"type":"STRING","value":"NUM_COLUMNS"}}}},"visible":true},"4":{"slot":4,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"5":{"slot":5,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Table Columns","elements":{},"visible":false},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":false},"10":{"slot":10,"name":"Limit","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"100"}}}},"visible":false},"11":{"slot":11,"name":"Order By","elements":{},"visible":false},"12":{"slot":12,"name":"Sort","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Ascending"}}}},"visible":false},"13":{"slot":13,"name":"Filter Conditions","elements":{},"visible":false},"14":{"slot":14,"name":"Combine Conditions","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AND"}}}},"visible":false},"20":{"slot":20,"name":"Basic / Advanced","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Advanced"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2088":{"id":2088,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":256,"y":128,"width":32,"height":32,"inputConnectorIDs":[2117],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error - Create Table"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"${JV_Message}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_JOB_ID"},"2":{"slot":2,"type":"STRING","value":"${run_history_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_RUN_KEY"},"2":{"slot":2,"type":"STRING","value":"${JV_Status}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"${JV_TargetTable}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2089":{"id":2089,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":544,"y":-128,"width":32,"height":32,"inputConnectorIDs":[2122],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error - Loading File"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"${JV_Message}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_JOB_ID"},"2":{"slot":2,"type":"STRING","value":"${run_history_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_RUN_KEY"},"2":{"slot":2,"type":"STRING","value":"${JV_Status}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"${JV_TargetTable}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2090":{"id":2090,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-369209785,"x":-336,"y":0,"width":32,"height":32,"inputConnectorIDs":[2109],"outputSuccessConnectorIDs":[2105],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Add FILENAME Column"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRD_ColumnNames"}}}},"visible":true},"3":{"slot":3,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"4":{"slot":4,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_FILENAME"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"DECIMAL","value":"1000"},"4":{"slot":4,"type":"DECIMAL","value":"0"},"5":{"slot":5,"type":"STRING","value":null},"6":{"slot":6,"type":"STRING","value":"NO"},"7":{"slot":7,"type":"STRING","value":"NO"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAMEDATE"},"2":{"slot":2,"type":"STRING","value":"VARCHAR"},"3":{"slot":3,"type":"DECIMAL","value":"50"},"4":{"slot":4,"type":"DECIMAL","value":"0"},"5":{"slot":5,"type":"STRING","value":""},"6":{"slot":6,"type":"STRING","value":"NO"},"7":{"slot":7,"type":"STRING","value":"NO"}}}},"visible":true},"5":{"slot":5,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"6":{"slot":6,"name":"Column Mapping","elements":{},"visible":false},"7":{"slot":7,"name":"Append/Prepend","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Append"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2091":{"id":2091,"inputCardinality":"ZERO","outputCardinality":"ZERO","connectorHint":"UNCONDITIONAL","executionHint":"NONE","implementationID":1491478149,"x":672,"y":0,"width":32,"height":32,"inputConnectorIDs":[2116],"outputSuccessConnectorIDs":[2111],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Archive File"}}}},"visible":true},"2":{"slot":2,"name":"Azure Account Key","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"ew4JBn9Bk0WqqtfJVMN2bcfGaJdZz/eP8dOQIGAX5Abd9iUZ43fe47BDl96oP3m7pp1co9I1lvpWjO4R3Sc2iQ=="}}}},"visible":true},"3":{"slot":3,"name":"Add Time Stamp","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"TRUE"}}}},"visible":true},"4":{"slot":4,"name":"Archive Base folder","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${BASE_FOLDER}Archive"}}}},"visible":true},"5":{"slot":5,"name":"Failed Base Folder","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${BASE_FOLDER}Failed"}}}},"visible":true},"6":{"slot":6,"name":"Process status","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_Status}"}}}},"visible":true},"7":{"slot":7,"name":"Source Base folder","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${BASE_FOLDER}"}}}},"visible":true},"8":{"slot":8,"name":"Source Filename","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${FILENAME}"}}}},"visible":true},"9":{"slot":9,"name":"Delete Source File","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2092":{"id":2092,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-48,"y":-128,"width":32,"height":32,"inputConnectorIDs":[2118],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error - Create Table Name"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"${JV_Message}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_JOB_ID"},"2":{"slot":2,"type":"STRING","value":"${run_history_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_RUN_KEY"},"2":{"slot":2,"type":"STRING","value":"${JV_Status}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"${JV_TargetTable}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2093":{"id":2093,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1773186829,"x":-48,"y":0,"width":32,"height":32,"inputConnectorIDs":[2106],"outputSuccessConnectorIDs":[2102],"outputFailureConnectorIDs":[2118],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create Table Names"}}}},"visible":true},"2":{"slot":2,"name":"Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"###\n# Variables are directly accessible: \n#   print (myvar)\n# Updating a variable:\n#   context.updateVariable('myvar', 'new-value')\n# Grid Variables are accessible via the context:\n#   print (context.getGridVariable('mygridvar'))\n# Updating a grid variable:\n#   context.updateGridVariable('mygridvar', [['list','of'],['lists','!']])\n# A database cursor can be accessed from the context (Jython only):\n#   cursor = context.cursor()\n#   cursor.execute('select count(*) from mytable')\n#   rowcount = cursor.fetchone()[0]\n###\n\nimport re\nimport datetime\n\n#####################################################\n#### NEED TO RUN AS PYTHON 3 for Translate command\n#####################################################\n\n# (.*)_(.*)\\..*\\..*\n# PHinp_05182021.txt.gz\n\n\n#### STG Table\nprint(\"File Pattern - \", JV_TableFromFileNamePattern)\nfileNameTemp = re.findall(JV_TableFromFileNamePattern, FILENAME)\nprint(fileNameTemp)\nprint(len(fileNameTemp))\n\nif len(fileNameTemp[0]) == 2:\n  ## Grab the date/datetime\n  dateTime = fileNameTemp[0][1]\n  tableFromFilename = fileNameTemp[0][0]\nelse:\n  tableFromFilename = fileNameTemp[0]\n  # if the date isn't in the filename default to todays date\n  today = datetime.datetime.today()\n  dateTime = today.strftime('%Y%m%d')\n  \nprint(tableFromFilename)\ncontext.updateVariable('JV_FileNameDate', dateTime)\nprint(JV_FileNameDate)\n\ntableName = BASE_FOLDER.upper() + tableFromFilename.upper()\n##  Characters to be Replaced in string\nx = \"-/\"\n##  Characters to be placed in string\ny = \"__\"\nreplaceTable = tableName.maketrans(x, y)\ntableName = tableName.translate(replaceTable)\ncontext.updateVariable('JV_TableName', tableName)\n\nprint(\"Staging Table Name - \", JV_TableName)\n\n### Temp Table\ntempTableName = BASE_FOLDER.upper() + FILENAME.upper()\n##  Characters to be Replaced in string\nx = \"-/.\"\n##  Characters to be placed in string\ny = \"___\"\nreplaceTable = tempTableName.maketrans(x, y)\ntempTableName = tempTableName.translate(replaceTable)\n# If the Temp table and STG table are the same add TEMP to end of temp table\nif tempTableName == tableName:\n  tempTableName += '_TEMP'\ncontext.updateVariable('JV_TempTableName', tempTableName)\n\nprint(\"Temp Table Name - \", JV_TempTableName)\n"}}}},"visible":true},"3":{"slot":3,"name":"Interpreter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Python 3"}}}},"visible":true},"4":{"slot":4,"name":"Timeout","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":"360"}}}},"visible":true},"5":{"slot":5,"name":"User","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Restricted"}}}},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2094":{"id":2094,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-192,"y":112,"width":32,"height":32,"inputConnectorIDs":[2120],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error - File Parameters"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"${JV_Message}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_JOB_ID"},"2":{"slot":2,"type":"STRING","value":"${run_history_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_RUN_KEY"},"2":{"slot":2,"type":"STRING","value":"${JV_Status}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"${JV_TargetTable}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2095":{"id":2095,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"TRANSFORM","implementationID":1785813072,"x":-496,"y":-128,"width":32,"height":32,"inputConnectorIDs":[2121],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error - Get List of Column Names"}}}},"visible":true},"2":{"slot":2,"name":"Orchestration Job","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Log Error"}}}},"visible":true},"3":{"slot":3,"name":"","elements":{},"visible":false},"4":{"slot":4,"name":"Set Scalar Variables","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"JV_MESSAGE"},"2":{"slot":2,"type":"STRING","value":"${JV_Message}"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_JOB_ID"},"2":{"slot":2,"type":"STRING","value":"${run_history_id}"}}},"3":{"slot":3,"values":{"1":{"slot":1,"type":"STRING","value":"JV_ETL_RUN_KEY"},"2":{"slot":2,"type":"STRING","value":"${JV_Status}"}}},"4":{"slot":4,"values":{"1":{"slot":1,"type":"STRING","value":"JV_TABLE_NAME"},"2":{"slot":2,"type":"STRING","value":"${JV_TargetTable}"}}}},"visible":true},"5":{"slot":5,"name":"Set Grid Variables","elements":{},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2096":{"id":2096,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1989138124,"x":544,"y":0,"width":32,"height":32,"inputConnectorIDs":[2108],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[2122],"outputUnconditionalConnectorIDs":[2116],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy of Load data from File"}}}},"visible":true},"4":{"slot":4,"name":"Azure Storage Location","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"azure://${BASE_FOLDER}${FILENAME}"}}}},"visible":true},"5":{"slot":5,"name":"Warehouse","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Environment Default]"}}}},"visible":true},"6":{"slot":6,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetDatabase}"}}}},"visible":true},"7":{"slot":7,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetSchema}"}}}},"visible":true},"8":{"slot":8,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TempTableName}"}}}},"visible":true},"9":{"slot":9,"name":"Load Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"GRD_ColumnNames"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Column_Name"}}}},"visible":true},"10":{"slot":10,"name":"Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"11":{"slot":11,"name":"File Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"CSV"}}}},"visible":true},"12":{"slot":12,"name":"Compression","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"AUTO"}}}},"visible":true},"20":{"slot":20,"name":"Record Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"21":{"slot":21,"name":"Field Delimiter","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_Field_Delimiter}"}}}},"visible":true},"22":{"slot":22,"name":"Skip Header","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_SkipHeader}"}}}},"visible":true},"23":{"slot":23,"name":"Date Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"YYYYMMDD"}}}},"visible":true},"24":{"slot":24,"name":"Time Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"25":{"slot":25,"name":"Timestamp Format","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"YYYYMMDD HH24:MI:SS"}}}},"visible":true},"26":{"slot":26,"name":"","elements":{},"visible":false},"27":{"slot":27,"name":"Escape","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"28":{"slot":28,"name":"Escape Unenclosed Field","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"NONE"}}}},"visible":true},"29":{"slot":29,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"30":{"slot":30,"name":"Field Optionally Enclosed","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_FieldEnclosed}"}}}},"visible":true},"31":{"slot":31,"name":"Null If","elements":{},"visible":true},"32":{"slot":32,"name":"Error On Column Count Mismatch","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"33":{"slot":33,"name":"Empty Field as Null","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"34":{"slot":34,"name":"Encoding Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"35":{"slot":35,"name":"Skip Blank Lines","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"36":{"slot":36,"name":"Replace Invalid Characters","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"True"}}}},"visible":true},"40":{"slot":40,"name":"Enable Octal","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"41":{"slot":41,"name":"Allow Duplicates","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"42":{"slot":42,"name":"Strip Outer Array","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"43":{"slot":43,"name":"Strip Null Values","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"44":{"slot":44,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"45":{"slot":45,"name":"Nest Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"46":{"slot":46,"name":"Null If","elements":{},"visible":false},"47":{"slot":47,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"50":{"slot":50,"name":"Null If","elements":{},"visible":false},"51":{"slot":51,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"60":{"slot":60,"name":"Ignore UTF8 Errors","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"61":{"slot":61,"name":"Preserve Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"62":{"slot":62,"name":"Strip Outer Element","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"63":{"slot":63,"name":"Disable Snowflake Data","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"64":{"slot":64,"name":"Disable Auto Convert","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"66":{"slot":66,"name":"Null If","elements":{},"visible":false},"67":{"slot":67,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"70":{"slot":70,"name":"Null If","elements":{},"visible":false},"71":{"slot":71,"name":"Trim Space","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":false},"105":{"slot":105,"name":"Authentication","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Credentials"}}}},"visible":true},"106":{"slot":106,"name":"Storage Integration","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"120":{"slot":120,"name":"On Error","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Abort Statement"}}}},"visible":true},"121":{"slot":121,"name":"n","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":false},"122":{"slot":122,"name":"Size Limit (B)","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"123":{"slot":123,"name":"Purge Files","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"124":{"slot":124,"name":"Truncate Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"125":{"slot":125,"name":"Force Load","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"False"}}}},"visible":true},"126":{"slot":126,"name":"Match By Column Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"None"}}}},"visible":false},"200":{"slot":200,"name":"Stage","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"[Custom]"}}}},"visible":true},"201":{"slot":201,"name":"Pattern","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":".*"}}}},"visible":true},"203":{"slot":203,"name":"Metadata Fields","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2097":{"id":2097,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-1291941950,"x":1104,"y":0,"width":32,"height":32,"inputConnectorIDs":[2110],"outputSuccessConnectorIDs":[],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Drop Temp Table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetDatabase}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetSchema}"}}}},"visible":true},"4":{"slot":4,"name":"Target Table","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TempTableName}"}}}},"visible":true},"5":{"slot":5,"name":"Ignore Missing","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Yes"}}}},"visible":true},"6":{"slot":6,"name":"","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2098":{"id":2098,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":816,"y":0,"width":32,"height":32,"inputConnectorIDs":[2111],"outputSuccessConnectorIDs":[2107],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Update the FILENAME Column"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"UPDATE ${JV_TargetDatabase}.${JV_TargetSchema}.${JV_TempTableName}\nSET SOURCE_FILENAME = '${FILENAME}',\n\tFILENAMEDATE = '${JV_FileNameDate}'\n"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2099":{"id":2099,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1395699082,"x":400,"y":0,"width":32,"height":32,"inputConnectorIDs":[2112],"outputSuccessConnectorIDs":[2108],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Remove FILENAME Column"}}}},"visible":true},"2":{"slot":2,"name":"Target Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"GRD_ColumnNames"}}}},"visible":true},"3":{"slot":3,"name":"Key Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Column_Name"}}}},"visible":true},"4":{"slot":4,"name":"Operation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Not In"}}}},"visible":true},"5":{"slot":5,"name":"Fixed/Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Fixed"}}}},"visible":true},"6":{"slot":6,"name":"Values Grid","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"SOURCE_FILENAME"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"STRING","value":"FILENAMEDATE"}}}},"visible":true},"7":{"slot":7,"name":"Source Grid Variable","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":false},"8":{"slot":8,"name":"Key Column Mapping","elements":{},"visible":false}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2100":{"id":2100,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":-798585337,"x":976,"y":0,"width":32,"height":32,"inputConnectorIDs":[2107],"outputSuccessConnectorIDs":[2110],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Copy Temp to Stage Table"}}}},"visible":true},"2":{"slot":2,"name":"SQL Script","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"INSERT INTO ${JV_TargetDatabase}.${JV_TargetSchema}.${JV_TableName}\nSELECT *\nFROM\t${JV_TargetDatabase}.${JV_TargetSchema}.${JV_TempTableName}"}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]},"2101":{"id":2101,"inputCardinality":"ONE","outputCardinality":"MANY","connectorHint":"SUCCESS_FAIL","executionHint":"EXECUTE","implementationID":1611478312,"x":96,"y":0,"width":32,"height":32,"inputConnectorIDs":[2102],"outputSuccessConnectorIDs":[2104],"outputFailureConnectorIDs":[],"outputUnconditionalConnectorIDs":[],"outputTrueConnectorIDs":[],"outputFalseConnectorIDs":[],"exportMappings":{"1":{"slot":1,"fromId":null,"fromName":"Message","mapTo":"JV_Message"},"2":{"slot":2,"fromId":null,"fromName":"Status","mapTo":"JV_Status"}},"parameters":{"1":{"slot":1,"name":"Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Create TEMP Table"}}}},"visible":true},"2":{"slot":2,"name":"Database","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetDatabase}"}}}},"visible":true},"3":{"slot":3,"name":"Schema","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TargetSchema}"}}}},"visible":true},"4":{"slot":4,"name":"New Table Name","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"${JV_TempTableName}"}}}},"visible":true},"5":{"slot":5,"name":"Columns","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"GRID","value":"GRD_ColumnNames"}}},"2":{"slot":2,"values":{"1":{"slot":1,"type":"GRID","value":"Column_Name"},"2":{"slot":2,"type":"GRID","value":"Data_Type"},"3":{"slot":3,"type":"GRID","value":"Size"},"4":{"slot":4,"type":"GRID","value":"Precision"},"5":{"slot":5,"type":"GRID","value":"Default_Value"},"6":{"slot":6,"type":"GRID","value":"Not_Null"},"7":{"slot":7,"type":"GRID","value":"Unique_Value"}}}},"visible":true},"6":{"slot":6,"name":"Create/Replace","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Replace"}}}},"visible":true},"7":{"slot":7,"name":"Clustering Keys","elements":{},"visible":true},"8":{"slot":8,"name":"Data Retention Time in Days","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"INTEGER","value":""}}}},"visible":true},"9":{"slot":9,"name":"Comment","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true},"11":{"slot":11,"name":"Primary Keys","elements":{},"visible":true},"12":{"slot":12,"name":"Table Type","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":"Transient"}}}},"visible":true},"13":{"slot":13,"name":"Default DDL Collation","elements":{"1":{"slot":1,"values":{"1":{"slot":1,"type":"STRING","value":""}}}},"visible":true}},"expectedFailure":null,"activationStatus":"ENABLED","outputIterationConnectorIDs":[],"inputIterationConnectorIDs":[]}},"successConnectors":{"2102":{"id":2102,"sourceID":2093,"targetID":2101},"2103":{"id":2103,"sourceID":2087,"targetID":2086},"2104":{"id":2104,"sourceID":2101,"targetID":2080},"2105":{"id":2105,"sourceID":2090,"targetID":2082},"2106":{"id":2106,"sourceID":2082,"targetID":2093},"2107":{"id":2107,"sourceID":2098,"targetID":2100},"2108":{"id":2108,"sourceID":2099,"targetID":2096},"2109":{"id":2109,"sourceID":2084,"targetID":2090},"2110":{"id":2110,"sourceID":2100,"targetID":2097},"2111":{"id":2111,"sourceID":2091,"targetID":2098},"2112":{"id":2112,"sourceID":2080,"targetID":2099}},"failureConnectors":{"2117":{"id":2117,"sourceID":2080,"targetID":2088},"2118":{"id":2118,"sourceID":2093,"targetID":2092},"2119":{"id":2119,"sourceID":2087,"targetID":2083},"2120":{"id":2120,"sourceID":2082,"targetID":2094},"2121":{"id":2121,"sourceID":2084,"targetID":2095},"2122":{"id":2122,"sourceID":2096,"targetID":2089}},"unconditionalConnectors":{"2115":{"id":2115,"sourceID":2085,"targetID":2087},"2116":{"id":2116,"sourceID":2096,"targetID":2091}},"trueConnectors":{"2113":{"id":2113,"sourceID":2086,"targetID":2084}},"falseConnectors":{"2114":{"id":2114,"sourceID":2086,"targetID":2081}},"iterationConnectors":{},"noteConnectors":{},"notes":{},"variables":{"BASE_FOLDER":{"definition":{"name":"BASE_FOLDER","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"stguse2prddwsnwfl/datalake/"},"ETL_DATABASE":{"definition":{"name":"ETL_DATABASE","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"PRD_EDW_STG"},"ETL_SCHEMA":{"definition":{"name":"ETL_SCHEMA","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"ETL"},"FILENAME":{"definition":{"name":"FILENAME","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"accn_ordered_tests_reprice_history_202112100205.txt.gz"},"FILE_LOADER_TABLE":{"definition":{"name":"FILE_LOADER_TABLE","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"FILE_LOADER"},"JV_AzurePathFileName":{"definition":{"name":"JV_AzurePathFileName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"cbhsnowflake/data-files/to-snowflake/PHinp_05182021.txt.gz"},"JV_Component":{"definition":{"name":"JV_Component","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"JV_FieldEnclosed":{"definition":{"name":"JV_FieldEnclosed","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":null},"JV_Field_Delimiter":{"definition":{"name":"JV_Field_Delimiter","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"|"},"JV_FileNameDate":{"definition":{"name":"JV_FileNameDate","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"JV_Message":{"definition":{"name":"JV_Message","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"JV_NumberColumns":{"definition":{"name":"JV_NumberColumns","type":"DECIMAL","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"JV_SkipHeader":{"definition":{"name":"JV_SkipHeader","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"JV_Status":{"definition":{"name":"JV_Status","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"Success"},"JV_TableFromFileNamePattern":{"definition":{"name":"JV_TableFromFileNamePattern","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"(.*)_(.*)\\..*\\..*"},"JV_TableName":{"definition":{"name":"JV_TableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""},"JV_TargetDatabase":{"definition":{"name":"JV_TargetDatabase","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"PRD_EDW_STG"},"JV_TargetSchema":{"definition":{"name":"JV_TargetSchema","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"XIFIN"},"JV_TargetTable":{"definition":{"name":"JV_TargetTable","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":"STGUSE2PRDDWSNWFL_DATALAKE_ACCN_BILLED_PROCEDURES_202112080108"},"JV_TempTableName":{"definition":{"name":"JV_TempTableName","type":"TEXT","scope":"BRANCH","description":"","visibility":"PUBLIC"},"value":""}},"grids":{"GRD_ColumnNames":{"definition":{"name":"GRD_ColumnNames","scope":"BRANCH","definitions":[{"name":"Column_Name","type":"TEXT"},{"name":"Data_Type","type":"TEXT"},{"name":"Size","type":"DECIMAL"},{"name":"Precision","type":"DECIMAL"},{"name":"Default_Value","type":"TEXT"},{"name":"Not_Null","type":"TEXT"},{"name":"Unique_Value","type":"TEXT"}],"description":"","visibility":"PUBLIC"},"values":[{"values":["Test","VARCHAR","255","0","","NO","NO"]},{"values":["Testnum","NUMBER","38","0","","NO","NO"]},{"values":["testdate","TIMESTAMP","0","9","","NO","NO"]}]}}},"info":{"name":"Azure File Loader Step","description":"","type":"ORCHESTRATION","tag":"e2c2e9a6-a00c-41c0-8546-1ec09a83e576"}}